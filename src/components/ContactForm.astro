<form
    id="contactForm"
    action="https://formspree.io/f/mvzgpozj"
    method="POST"
    class="max-w-xl mx-auto bg-hdtBlue text-white p-8 rounded-2xl space-y-6 shadow-2xl"
>
    <!-- Title -->
    <div class="text-center space-y-2">
        <h3 class="text-2xl md:text-3xl text-white font-semibold tracking-wide">
            NHẬN TƯ VẤN MIỄN PHÍ
        </h3>
        <p class="text-sm text-white">
            Để lại thông tin – chúng tôi sẽ liên hệ trong thời gian sớm nhất
        </p>
    </div>

    <!-- Inputs -->
    <div class="space-y-4">
        <input
            name="full_name"
            required
            placeholder="Họ và tên"
            class="w-full px-4 py-3 rounded-xl text-gray-800 text-base
                   focus:outline-none focus:ring-2 focus:ring-white/70"
        />

        <input
            name="phone"
            type="tel"
            required
            placeholder="Số điện thoại"
            class="w-full px-4 py-3 rounded-xl text-gray-800 text-base
                   focus:outline-none focus:ring-2 focus:ring-white/70"
        />

        <input
            name="email"
            type="email"
            required
            placeholder="Email"
            class="w-full px-4 py-3 rounded-xl text-gray-800 text-base
                   focus:outline-none focus:ring-2 focus:ring-white/70"
        />

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <input
                name="from_location"
                required
                placeholder="Nơi gửi"
                class="w-full px-4 py-3 rounded-xl text-gray-800 text-base
                       focus:outline-none focus:ring-2 focus:ring-white/70"
            />

            <input
                name="to_location"
                required
                placeholder="Nơi nhận"
                class="w-full px-4 py-3 rounded-xl text-gray-800 text-base
                       focus:outline-none focus:ring-2 focus:ring-white/70"
            />
        </div>

        <textarea
            name="cargo_info"
            rows="4"
            placeholder="Thông tin hàng hóa: loại hàng, trọng lượng, kích thước (nếu có)..."
            class="w-full px-4 py-3 rounded-xl text-gray-800 text-base
                   focus:outline-none focus:ring-2 focus:ring-white/70 resize-none"
        ></textarea>
    </div>

    <!-- Button -->
    <button
        id="submitBtn"
        type="submit"
        class="relative w-full py-3 rounded-xl font-semibold
               bg-white text-hdtBlue
               transition-all duration-300 ease-out
               hover:-translate-y-0.5 hover:shadow-xl
               active:translate-y-0 active:shadow-md
               focus:outline-none focus:ring-2 focus:ring-white/60
               disabled:opacity-60 disabled:cursor-not-allowed"
    >
        <span id="btnText">Nhận thông tin tư vấn</span>

        <!-- Loading spinner -->
        <span
            id="btnLoading"
            class="hidden absolute inset-0 flex items-center justify-center"
        >
            <svg
                class="w-5 h-5 animate-spin text-hdtBlue"
                viewBox="0 0 24 24"
                fill="none"
            >
                <circle
                    class="opacity-25"
                    cx="12"
                    cy="12"
                    r="10"
                    stroke="currentColor"
                    stroke-width="4"></circle>
                <path
                    class="opacity-75"
                    fill="currentColor"
                    d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
            </svg>
        </span>
    </button>

    <!-- Message -->
    <p
        id="formMessage"
        class="hidden text-center text-sm font-medium rounded-lg py-3 transition-all"
    >
    </p>
</form>

<script>
    const form = document.getElementById("contactForm");
    const messageBox = document.getElementById("formMessage");
    const submitBtn = document.getElementById("submitBtn");
    const btnText = document.getElementById("btnText");
    const btnLoading = document.getElementById("btnLoading");

    form.addEventListener("submit", async function (e) {
        e.preventDefault();

        // Loading state
        submitBtn.disabled = true;
        btnText.classList.add("opacity-0");
        btnLoading.classList.remove("hidden");

        const formData = new FormData(form);

        try {
            const res = await fetch(form.action, {
                method: form.method,
                body: formData,
                headers: { Accept: "application/json" },
            });

            if (!res.ok) throw new Error();

            showMessage(
                "Cảm ơn bạn đã gửi thông tin! Chúng tôi sẽ liên hệ trong thời gian sớm nhất.",
                "success",
            );
            form.reset();
        } catch {
            showMessage("Có lỗi xảy ra. Vui lòng thử lại sau.", "error");
        } finally {
            // Reset button
            submitBtn.disabled = false;
            btnText.classList.remove("opacity-0");
            btnLoading.classList.add("hidden");
        }
    });

    function showMessage(text, type) {
        messageBox.textContent = text;
        messageBox.className =
            "text-center text-sm font-medium rounded-lg py-3 transition-all " +
            (type === "success"
                ? "bg-green-100 text-green-700"
                : "bg-red-100 text-red-700");

        messageBox.classList.remove("hidden");

        // Auto hide after 4s
        setTimeout(() => {
            messageBox.classList.add("opacity-0");
            setTimeout(() => {
                messageBox.classList.add("hidden");
                messageBox.classList.remove("opacity-0");
            }, 300);
        }, 4000);
    }
</script>
